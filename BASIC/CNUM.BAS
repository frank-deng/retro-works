10 DEFINT A-Z: DIM N$(15): DIM IMG(18,15): DIM IMGT(18): R1=0: R2=0
11 GOSUB 300: KEY OFF: SCREEN 2: CLS: LOCATE 1,1,1
20 INPUT "Input Number: ",IN$: L=LEN(IN$)
30 IF IN$="" THEN GOTO 20 ELSE IF L > 16 THEN PRINT "Input too long.": GOTO 80
40 LOCATE ,,0: X=0: Y=16
50 IF L < 8 THEN S1$=IN$: GOSUB 200: GOTO 80
60 S1$=MID$(IN$,1,L-8): GOSUB 200: IF R1<>0 THEN ID=14: GOSUB 400
70 S1$=MID$(IN$,L-8+1,8): GOSUB 200
80 WHILE INPUT$(1)="": WEND : SCREEN 0: END
100 IF VAL(S2$)=0 THEN R2=0: RETURN
110 R2=1: OZ=0: L2=LEN(S2$): FOR I=L2 TO 1 STEP -1
120 D=VAL(MID$(S2$, L2+1-I, 1))
130 IF D=0 THEN OZ=1: GOTO 170
140 IF OZ<>0 THEN ID=0: GOSUB 400: OZ=0
150 ID=D: GOSUB 400
160 IF I=2 THEN ID=10:GOSUB 400 ELSE IF I=3 THEN ID=11:GOSUB 400 ELSE IF I=4 THEN ID=12:GOSUB 400
170 NEXT I: RETURN
200 L1=LEN(S1$): IF L1<=4 THEN S2$=S1$: GOSUB 100: R1=R2: RETURN
210 R1=0: S2$=MID$(S1$,1,L1-4): GOSUB 100: R1=R2
220 IF R2<>0 THEN ID=13:GOSUB 400
230 S2$=MID$(S1$,L1-4+1,4): GOSUB 100: R1=R1 OR R2
240 RETURN
300 FOR I=0 TO 14: IMG(0,I)=16: IMG(1,I)=16
310 FOR J=2 TO 17: READ V: T=0
320 POKE VARPTR(T)+1,PEEK(VARPTR(V)): POKE VARPTR(T),PEEK(VARPTR(V)+1): IMG(J,I)=T
330 NEXT J: NEXT I: RETURN
400 FOR IMGTA=0 TO 17: IMGT(IMGTA)=IMG(IMGTA,ID): NEXT IMGTA
410 PUT (X,Y),IMGT,PSET: IF X>=640 THEN X=0: Y=Y+16 ELSE X=X+16
420 RETURN
500 DATA 8176,256,32766,16642,-25228,256,7536,640,3168,12824,-16122,4064,64,640,256,128
510 DATA 256,32764,256,16376,0,32766,16386,-24588,0,8176,4112,4112,8176,2080,1092,-2
520 DATA 40,36,-2,32,16288,32,32736,32,16288,8352,9376,9376,9362,2578,4490,24710
530 DATA 1024,2080,8176,528,516,-2,1152,2112,2080,6096,8206,-16316,4064,0,16,16376
540 DATA 32,15392,8444,8228,15870,8228,8444,15392,8224,8700,-480,4132,9726,32288,544,32
550 DATA 4096,4104,6140,8320,8320,24704,-24440,10236,8456,8456,8456,8712,8712,8712,16382,8192
560 DATA 32,31776,17440,18940,18464,20512,18468,19454,17440,17700,17700,26916,20772,16676,16892,16644
570 DATA 8320,4224,16520,8444,3968,4228,24708,8316,8448,260,-2,896,1344,6448,-7922,256
580 DATA 8260,10212,9284,9300,-940,10196,8724,10772,14292,8788,-7596,8772,9284,9540,-22380,16392
590 DATA 64,1088,-440,4348,4232,4232,32016,4624,4128,4128,7760,-4016,16520,264,518,3072
600 DATA 4160,4160,4256,4256,-752,4616,5622,7168,12296,-11268,4616,4616,4616,4616,21496,8712
610 DATA 2048,2052,4094,4160,4160,12424,21500,-28152,4616,4616,5112,4616,4616,4616,5112,4616
620 DATA 2064,2104,3008,4160,4160,12352,20548,-24578,4160,4160,4160,4160,4160,4160,4160,4160
630 DATA 0,4,-2,512,512,528,1016,528,528,1040,1040,1040,2064,4112,8352,16448
640 DATA 2048,2048,3064,4112,4128,12352,20608,-28416,4608,4608,5120,5120,5122,5122,5118,4096
